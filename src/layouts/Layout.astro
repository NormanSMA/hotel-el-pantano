---
import '../styles/global.css';
import Analytics from '@vercel/analytics/astro';
import SpeedInsights from '@vercel/speed-insights/astro';

interface Props {
	title: string;
    description?: string;
    image?: string;
    url?: string;
}

const { 
    title, 
    description = "Hotel y Restaurante El Pantano en Jalapa, Nicaragua. Un rincón campestre único para crear recuerdos inolvidables.",
    image = "/images/hero/jardin-nocturno-luces.webp",
    url = Astro.url.href
} = Astro.props;

const siteUrl = 'https://www.hotel-el-pantano.org';
const ogImage = image.startsWith('http') ? image : `${siteUrl}${image}`;
---

<!doctype html>
<html lang="es" class="scroll-smooth">
	<head>
		<meta charset="UTF-8" />
		<script is:inline>
			const theme = (() => {
				if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
					return localStorage.getItem('theme');
				}
				if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
					return 'dark';
				}
				return 'light';
			})();
		
			if (theme === 'light') {
				document.documentElement.classList.remove('dark');
			} else {
				document.documentElement.classList.add('dark');
			}
			window.localStorage.setItem('theme', theme);
		</script>
		<meta name="description" content={description} />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/x-icon" href="/favicon.ico" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>

		<!-- Open Graph -->
		<meta property="og:type" content="website" />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={ogImage} />
		<meta property="og:url" content={url} />
		<meta property="og:locale" content="es_NI" />
		<meta property="og:site_name" content="Hotel El Pantano" />

		<!-- Twitter Cards -->
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:title" content={title} />
		<meta name="twitter:description" content={description} />
		<meta name="twitter:image" content={ogImage} />

		<!-- Schema.org JSON-LD -->
		<script type="application/ld+json" set:html={JSON.stringify({
			"@context": "https://schema.org",
			"@type": ["Hotel", "Restaurant"],
			"name": "Hotel y Restaurante El Pantano",
			"description": "Hotel y Restaurante campestre familiar en Jalapa, Nueva Segovia, Nicaragua.",
			"url": siteUrl,
			"telephone": "+50586538494",
			"email": "info@hotelelpantano.com",
			"image": `${siteUrl}/images/hero/jardin-nocturno-luces.webp`,
			"logo": `${siteUrl}/logo.png`,
			"address": {
				"@type": "PostalAddress",
				"addressLocality": "Jalapa",
				"addressRegion": "Nueva Segovia",
				"addressCountry": "NI"
			},
			"geo": {
				"@type": "GeoCoordinates",
				"latitude": 13.9213568,
				"longitude": -86.1342697
			},
			"openingHoursSpecification": [
				{
					"@type": "OpeningHoursSpecification",
					"dayOfWeek": ["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],
					"opens": "11:00",
					"closes": "21:00",
					"description": "Restaurante"
				},
				{
					"@type": "OpeningHoursSpecification",
					"dayOfWeek": ["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],
					"opens": "00:00",
					"closes": "23:59",
					"description": "Recepción 24 horas"
				}
			],
			"priceRange": "$$",
			"servesCuisine": "Nicaragüense",
			"sameAs": [
				"https://www.facebook.com/hotelpantano"
			]
		})} />
	</head>
	<body class="bg-white flex flex-col min-h-screen">
		<slot />
        
        <!-- Back to Top Button -->
        <button 
            id="back-to-top" 
            aria-label="Volver arriba"
            class="fixed bottom-8 right-8 bg-primary hover:bg-primary-dark text-white p-3 rounded-full shadow-lg transform transition-all duration-300 opacity-0 translate-y-10 pointer-events-none z-50 hover:scale-110"
        >
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"/></svg>
        </button>

        <script>
            // Back to top button
            const btn = document.getElementById('back-to-top');
            
            const toggleVisibility = () => {
                if (window.scrollY > 300) {
                    btn?.classList.remove('opacity-0', 'translate-y-10', 'pointer-events-none');
                } else {
                    btn?.classList.add('opacity-0', 'translate-y-10', 'pointer-events-none');
                }
            };

            const scrollToTop = () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            window.addEventListener('scroll', toggleVisibility);
            btn?.addEventListener('click', scrollToTop);

            // Scroll animations with IntersectionObserver
            const animatedElements = document.querySelectorAll('[data-animate]');
            if (animatedElements.length > 0) {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('is-visible');
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });

                animatedElements.forEach(el => observer.observe(el));
            }
        </script>

        <Analytics />
        <SpeedInsights />
	</body>
</html>
